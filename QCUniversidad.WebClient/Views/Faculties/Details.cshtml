@model FacultyModel

@{
    ViewData["Title"] = $"Detalles de {Model.Name}";
    var schoolYear = ViewData["schoolYear"] as SchoolYearModel;
}

<div class="d-flex flex-column flex-sm-row justify-content-between align-items-center mb-4">
    <div class="d-flex flex-column flex-sm-row gap-2 align-items-center text-center text-sm-start">
        <div class="d-flex flex-column">
            <div class="banner-title">Detalles</div>
            <div class="banner-subtitle">de la facultad de la sede @Model.Campus</div>
        </div>
    </div>
    <div class="d-flex flex-column align-items-center schoolyear-header">
        <div class="index-schoolyearheader">
            Año escolar
        </div>
        <div class="index-schoolyearname">
            @schoolYear?.Name
        </div>
        @if (!string.IsNullOrEmpty(schoolYear?.Description))
        {
            <div class="index-schoolyeardesc">
                @schoolYear.Description
            </div>
        }
    </div>
</div>

<dl class="row">
    <dt class="col-sm-3">Nombre</dt>
    <dd class="col-sm-9">@Model.Name</dd>

    <dt class="col-sm-3">Sede</dt>
    <dd class="col-sm-9">@Model.Campus</dd>

    <dt class="col-sm-3">Identificador interno</dt>
    <dd class="col-sm-9">@Model.InternalId</dd>
</dl>

<ul class="nav nav-tabs" id="facultyDetails" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="careers-tab" data-bs-toggle="tab" data-bs-target="#careers" type="button" role="tab" aria-controls="careers" aria-selected="true"><span class="fa fa-graduation-cap"></span> Carreras</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="departments-tab" data-bs-toggle="tab" data-bs-target="#departments" type="button" role="tab" aria-controls="departments" aria-selected="false"><span class="fa fa-users-rectangle"></span> Departamentos</button>
    </li>
</ul>
<div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="careers" role="tabpanel" aria-labelledby="careers-tab">
        <div class="text-center m-5">
            <div class="spinner-grow text-success" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Cargando carreras...</p>
        </div>
    </div>
    <div class="tab-pane fade" id="departments" role="tabpanel" aria-labelledby="departmets-tab">
        <div class="text-center m-5">
            <div class="spinner-grow text-success" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p>Cargando departamentos...</p>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/lib/datatables/datatables.min.js"></script>
    <script>
        $(document).ready(function () {
            LoadCareers();
            LoadDepartments();
        });

        function LoadCareers() {
            $.ajax({
                url: `/faculties/FacultyCareers?facultyId=@Html.Raw($"{Model.Id}")`,
                type: "GET",
                success: function (data) {
                    const careersDiv = document.getElementById("careers");
                    careersDiv.innerHTML = data;
                    $('#careers-table').DataTable({
                        responsive: true,
                        language: {
                            url: '/lib/datatables/lang/datatables.spanish.json'
                        },
                        dom: 'Bfrtip',
                        buttons: [
                            'copyHtml5', 'excelHtml5', 'pdfHtml5'
                        ]
                    });
                },
                error: function (xhr, status, error) {
                    console.log(xhr, status, error);
                }
            });
        }

        function LoadDepartments() {
            $.ajax({
                url: `/faculties/FacultyDepartments?facultyId=@Html.Raw($"{Model.Id}")`,
                type: "GET",
                success: function (data) {
                    const disciplinesDiv = document.getElementById("departments");
                    disciplinesDiv.innerHTML = data;
                    $('#departments-table').DataTable({
                        responsive: true,
                        language: {
                            url: '/lib/datatables/lang/datatables.spanish.json'
                        },
                        dom: 'Bfrtip',
                        buttons: [
                            'copyHtml5', 'excelHtml5', 'pdfHtml5'
                        ]
                    });
                },
                error: function (xhr, status, error) {
                    console.log(xhr, status, error);
                }
            });
        }
    </script>
}